```javascript


// Action 제목: Require OTP MFA for admins
// 아래 코드 붙여넣기
exports.onExecutePostLogin = async (event, api) => {

    // Admin 역할 확인
    if (event.authorization?.roles?.includes('Admin')) {
        
        const enrolledFactors = event.user.factors || []; 
        const isOtpEnrolled = enrolledFactors.some(m => m.type === 'otp');

        if (isOtpEnrolled) {
            api.authentication.challengeWith({type: 'otp'});
        } else {
            api.multifactor.enable('otp'); 
        }
    }
};

